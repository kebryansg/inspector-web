<app-card [cardTitle]="'Filtros'" cardClass="mb-3">

  <form [formGroup]="itemFilter">
    <section class="row">
      <section class="col-12 col-md-6 col-lg-5">

        <app-item-control [titleControl]="'Grupo'">
          <dx-select-box [dataSource]="lsGrupo()"
                         displayExpr="Nombre"
                         valueExpr="ID"
                         formControlName="IDTarifaGrupo"
                         [searchEnabled]="true"
          />
        </app-item-control>

        <app-item-control [titleControl]="'Actividad'">
          <dx-select-box [dataSource]="lsActividad()"
                         displayExpr="Nombre"
                         valueExpr="ID"
                         formControlName="IDTarifaActividad"
                         [searchEnabled]="true"
                         [showClearButton]="true"
          />
        </app-item-control>

      </section>

      <!--
      <div class="col-12 col-md-6 col-lg-4">
        <div class="form-group form-default row">
          <label class="col-sm-12 col-form-label">
            Parroquia
          </label>
          <div class="col-sm-10 pr-0">
            <dx-select-box [dataSource]="lsGrupo()"
                           displayExpr="Nombre"
                           valueExpr="ID"
                           formControlName="IDTarifaGrupo"
                           [searchEnabled]="true"
            />
          </div>
        </div>
        <div class="form-group form-default row">
          <label class="col-sm-12 col-form-label">
            Sector
          </label>
          <div class="col-sm-10 pr-0">
            <dx-select-box [dataSource]="lsActividad()"
                           displayExpr="Nombre"
                           valueExpr="ID"
                           formControlName="IDTarifaActividad"
                           [searchEnabled]="true"
                           [showClearButton]="true"
            />
          </div>
        </div>
      </div>
      -->
    </section>
  </form>

  <section class="d-flex justify-content-end">
    <button class="btn btn-outline-primary"
            (click)="searchItems()">
      <i class="fa fa-search"></i>
      Consultar registros
    </button>
  </section>

</app-card>

<app-card [cardTitle]="'Listado de Empresas'">

  <form [formGroup]="itemInspectionGroup"
        (ngSubmit)="generateInspections()"
  >

    <section class="d-flex flex-row gap-2">
      <app-item-control [titleControl]="'Colaboradores'">
        <dx-select-box [dataSource]="lsColaborador$ | async"
                       valueExpr="ID"
                       displayExpr="Colaborador"
                       formControlName="idInspector"
        />
      </app-item-control>
      <app-item-control [titleControl]="'Fecha Tentativa'">
        <dx-date-box formControlName="dateTentative"
                     displayFormat="yyyy-mm-dd"
        />
      </app-item-control>
    </section>


    <section class="d-flex justify-content-between align-items-center mt-3">
      <p>
        Cantidad de items seleccionados: {{ lsSelectedItems().length }}
      </p>
      <button class="btn btn-success"
              type="submit">
        Crear Inspecciones
      </button>
    </section>

  </form>

  <hr class="my-3">

  <dx-data-grid [dataSource]="lsItemsDatagrid()"
                keyExpr="ID"
                [columnAutoWidth]="true"
                [columnMinWidth]="80"
                [hoverStateEnabled]="true"
                [rowAlternationEnabled]="true"
                [searchPanel]="{visible:true}"
                [loadPanel]="{enabled:true}"
                [headerFilter]="{visible:true}"
                (selectedRowKeysChange)="lsSelectedItems.set($event)"
                [showBorders]="true">
    <dxo-selection [showCheckBoxesMode]="'onClick'"
                   [selectAllMode]="'allPages'"
                   mode="multiple"
    />

    <dxo-paging [pageSize]="10"></dxo-paging>
    <dxo-pager [showPageSizeSelector]="true"
               [allowedPageSizes]="[10, 20, 40, 60]"
               [showInfo]="true"
    />

    <dxi-column dataField="RUC"
                [allowHeaderFiltering]="false"
    />
    <dxi-column dataField="NombreComercial"
                [allowHeaderFiltering]="false"
    />
    <dxi-column dataField="RazonSocial"
                [allowHeaderFiltering]="false"
    />
    <dxi-column dataField="Sector"/>
    <dxi-column dataField="Grupo"/>
    <dxi-column dataField="Actividad"/>
  </dx-data-grid>
</app-card>
